# 大屏统计数据接口文档

本文档描述了统计数据相关的API接口。所有统计数据接口均支持完整的CRUD操作。

## 通用接口模式

对于所有统计实体，均支持以下标准接口：

### 1. 获取所有记录
- **请求方法**: GET
- **URL**: `/api/stat/{entity-name}`
- **描述**: 获取指定类型的所有统计数据记录
- **返回**: 数组形式的实体记录列表

### 2. 获取单个记录
- **请求方法**: GET
- **URL**: `/api/stat/{entity-name}/{id}`
- **描述**: 根据ID获取单个统计数据记录
- **参数**: `id` - 记录ID
- **返回**: 单个实体记录

### 3. 创建记录
- **请求方法**: POST
- **URL**: `/api/stat/{entity-name}`
- **描述**: 创建新的统计数据记录
- **请求体**: 实体JSON对象
- **返回**: 创建后的实体记录

### 4. 更新记录
- **请求方法**: PUT
- **URL**: `/api/stat/{entity-name}/{id}`
- **描述**: 更新指定ID的统计数据记录
- **参数**: `id` - 记录ID
- **请求体**: 实体JSON对象（包含要更新的字段）
- **返回**: 更新后的实体记录

### 5. 删除记录
- **请求方法**: DELETE
- **URL**: `/api/stat/{entity-name}/{id}`
- **描述**: 删除指定ID的统计数据记录
- **参数**: `id` - 记录ID
- **返回**: 204 No Content

### 6. 批量删除记录
- **请求方法**: DELETE
- **URL**: `/api/stat/{entity-name}`
- **描述**: 批量删除多个统计数据记录
- **请求体**: JSON数组，包含要删除的记录ID，例如：`[1, 2, 3]`
- **返回**: 204 No Content

---

## 具体实体接口

### 1. 告警统计 (AlarmCountStat)

- **基础URL**: `/api/stat/alarm`
- **实体结构**:
```json
{
  "id": 1,
  "statDate": "2024-07-01",
  "successCount": 120,
  "suspiciousCount": 35,
  "attemptCount": 256,
  "createdAt": "2024-07-01T12:00:00",
  "updatedAt": "2024-07-01T12:00:00"
}
```

**接口示例**:
- `GET /api/stat/alarm` - 获取所有告警统计
- `GET /api/stat/alarm/1` - 获取ID为1的告警统计
- `POST /api/stat/alarm` - 创建新的告警统计
- `PUT /api/stat/alarm/1` - 更新ID为1的告警统计
- `DELETE /api/stat/alarm/1` - 删除ID为1的告警统计
- `DELETE /api/stat/alarm` - 批量删除告警统计

---

### 2. 资产统计 (AssetStat)

- **基础URL**: `/api/stat/asset`
- **实体结构**:
```json
{
  "id": 1,
  "statDate": "2024-07-01",
  "networkDevice": 10,
  "securityDevice": 5,
  "domainName": 3,
  "middleware": 2,
  "service": 8,
  "application": 4,
  "website": 6,
  "virtualDevice": 1,
  "port": 20,
  "host": 15,
  "databaseCount": 7,
  "osCount": 3,
  "createdAt": "2024-07-01T12:00:00",
  "updatedAt": "2024-07-01T12:00:00"
}
```

**接口示例**:
- `GET /api/stat/asset` - 获取所有资产统计
- `GET /api/stat/asset/1` - 获取ID为1的资产统计
- `POST /api/stat/asset` - 创建新的资产统计
- `PUT /api/stat/asset/1` - 更新ID为1的资产统计
- `DELETE /api/stat/asset/1` - 删除ID为1的资产统计
- `DELETE /api/stat/asset` - 批量删除资产统计

---

### 3. 攻击飞线 (AttackFlyline)

- **基础URL**: `/api/stat/attack`
- **实体结构**:
```json
{
  "id": 1,
  "sourceIp": "1.1.1.1",
  "targetIp": "2.2.2.2",
  "sourceLocationName": "美国·洛杉矶",
  "sourceLng": 118.123456,
  "sourceLat": 34.123456,
  "targetLocationName": "中国·北京",
  "targetLng": 116.123456,
  "targetLat": 39.123456,
  "attackMethod": "DDoS",
  "targetSystem": "Linux Nginx",
  "attackTime": "2024-07-16T09:00:00",
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/attack` - 获取所有攻击飞线
- `GET /api/stat/attack/1` - 获取ID为1的攻击飞线
- `POST /api/stat/attack` - 创建新的攻击飞线
- `PUT /api/stat/attack/1` - 更新ID为1的攻击飞线
- `DELETE /api/stat/attack/1` - 删除ID为1的攻击飞线
- `DELETE /api/stat/attack` - 批量删除攻击飞线

---

### 4. 区域报警统计 (AlertRegionStat)

- **基础URL**: `/api/stat/region`
- **实体结构**:
```json
{
  "id": 1,
  "regionName": "北京",
  "regionType": "domestic",
  "alertCount": 20,
  "statDate": "2024-07-16",
  "createdAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/region` - 获取所有区域报警统计
- `GET /api/stat/region/1` - 获取ID为1的区域报警统计
- `POST /api/stat/region` - 创建新的区域报警统计
- `PUT /api/stat/region/1` - 更新ID为1的区域报警统计
- `DELETE /api/stat/region/1` - 删除ID为1的区域报警统计
- `DELETE /api/stat/region` - 批量删除区域报警统计

---

### 5. 系统风险评分 (RiskScore)

- **基础URL**: `/api/stat/risk`
- **实体结构**:
```json
{
  "id": 1,
  "systemName": "系统A",
  "riskScore": 85.5,
  "scoreDate": "2024-07-16",
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/risk` - 获取所有风险评分
- `GET /api/stat/risk/1` - 获取ID为1的风险评分
- `POST /api/stat/risk` - 创建新的风险评分
- `PUT /api/stat/risk/1` - 更新ID为1的风险评分
- `DELETE /api/stat/risk/1` - 删除ID为1的风险评分
- `DELETE /api/stat/risk` - 批量删除风险评分

---

### 6. 安全事件 (SecurityEvent)

- **基础URL**: `/api/stat/event`
- **实体结构**:
```json
{
  "id": 1,
  "systemName": "系统A",
  "ipAddress": "1.1.1.1",
  "eventTime": "2024-07-16T08:00:00",
  "status": "unhandled",
  "source": "IDS",
  "content": "检测到异常流量",
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/event` - 获取所有安全事件
- `GET /api/stat/event/1` - 获取ID为1的安全事件
- `POST /api/stat/event` - 创建新的安全事件
- `PUT /api/stat/event/1` - 更新ID为1的安全事件
- `DELETE /api/stat/event/1` - 删除ID为1的安全事件
- `DELETE /api/stat/event` - 批量删除安全事件

---

### 7. 漏洞记录 (VulnerabilityRecord)

- **基础URL**: `/api/stat/vuln-record`
- **实体结构**:
```json
{
  "id": 1,
  "systemName": "系统A",
  "orgName": "单位A",
  "vulnSource": "扫描",
  "vulnType": "SQL注入",
  "foundTime": "2024-07-15T10:00:00",
  "fixContent": "已修复",
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/vuln-record` - 获取所有漏洞记录
- `GET /api/stat/vuln-record/1` - 获取ID为1的漏洞记录
- `POST /api/stat/vuln-record` - 创建新的漏洞记录
- `PUT /api/stat/vuln-record/1` - 更新ID为1的漏洞记录
- `DELETE /api/stat/vuln-record/1` - 删除ID为1的漏洞记录
- `DELETE /api/stat/vuln-record` - 批量删除漏洞记录

---

### 8. 漏洞统计 (VulnerabilityStat)

- **基础URL**: `/api/stat/vuln-stat`
- **实体结构**:
```json
{
  "id": 1,
  "foundTime": "2024-07-16T10:00:00",
  "highRiskCount": 3,
  "mediumRiskCount": 5,
  "lowRiskCount": 10,
  "createdAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/vuln-stat` - 获取所有漏洞统计
- `GET /api/stat/vuln-stat/1` - 获取ID为1的漏洞统计
- `POST /api/stat/vuln-stat` - 创建新的漏洞统计
- `PUT /api/stat/vuln-stat/1` - 更新ID为1的漏洞统计
- `DELETE /api/stat/vuln-stat/1` - 删除ID为1的漏洞统计
- `DELETE /api/stat/vuln-stat` - 批量删除漏洞统计

---

### 9. 异常事件统计 (AbnormalEventStat)

- **基础URL**: `/api/stat/abnormal-event`
- **实体结构**:
```json
{
  "id": 1,
  "statTime": "2024-07-16T10:00:00",
  "outbound": 10,
  "outsideToInside": 5,
  "lateralMove": 3,
  "other": 2,
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/abnormal-event` - 获取所有异常事件统计
- `GET /api/stat/abnormal-event/1` - 获取ID为1的异常事件统计
- `POST /api/stat/abnormal-event` - 创建新的异常事件统计
- `PUT /api/stat/abnormal-event/1` - 更新ID为1的异常事件统计
- `DELETE /api/stat/abnormal-event/1` - 删除ID为1的异常事件统计
- `DELETE /api/stat/abnormal-event` - 批量删除异常事件统计

---

### 10. 外联IP统计 (OutboundIpStat)

- **基础URL**: `/api/stat/outbound-ip`
- **实体结构**:
```json
{
  "id": 1,
  "location": "北京",
  "isDomestic": true,
  "statTime": "2024-07-16T10:00:00",
  "ipCount": 15,
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/outbound-ip` - 获取所有外联IP统计
- `GET /api/stat/outbound-ip/1` - 获取ID为1的外联IP统计
- `POST /api/stat/outbound-ip` - 创建新的外联IP统计
- `PUT /api/stat/outbound-ip/1` - 更新ID为1的外联IP统计
- `DELETE /api/stat/outbound-ip/1` - 删除ID为1的外联IP统计
- `DELETE /api/stat/outbound-ip` - 批量删除外联IP统计

---

### 11. 漏洞修复统计 (VulnerabilityFixStat)

- **基础URL**: `/api/stat/vuln-fix`
- **实体结构**:
```json
{
  "id": 1,
  "statTime": "2024-07-16",
  "fixedCount": 20,
  "unfixedCount": 5,
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/vuln-fix` - 获取所有漏洞修复统计
- `GET /api/stat/vuln-fix/1` - 获取ID为1的漏洞修复统计
- `POST /api/stat/vuln-fix` - 创建新的漏洞修复统计
- `PUT /api/stat/vuln-fix/1` - 更新ID为1的漏洞修复统计
- `DELETE /api/stat/vuln-fix/1` - 删除ID为1的漏洞修复统计
- `DELETE /api/stat/vuln-fix` - 批量删除漏洞修复统计

---

### 12. 设备状态统计 (DeviceStat)

- **基础URL**: `/api/stat/device`
- **实体结构**:
```json
{
  "id": 1,
  "statTime": "2024-07-16T10:00:00",
  "onlineCount": 256,
  "offlineCount": 15,
  "alarmCount": 8,
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/device` - 获取所有设备状态统计
- `GET /api/stat/device/1` - 获取ID为1的设备状态统计
- `POST /api/stat/device` - 创建新的设备状态统计
- `PUT /api/stat/device/1` - 更新ID为1的设备状态统计
- `DELETE /api/stat/device/1` - 删除ID为1的设备状态统计
- `DELETE /api/stat/device` - 批量删除设备状态统计

**特殊接口**:
- `GET /api/stat/device/range?startTime=2024-07-01T00:00:00&endTime=2024-07-31T23:59:59` - 按时间范围查询设备状态统计

---

### 13. 值班安排 (DutySchedule)

- **基础URL**: `/api/stat/duty`
- **实体结构**:
```json
{
  "id": 1,
  "orgName": "单位A",
  "leaderName": "张三",
  "leaderPhone": "13800000000",
  "dutyPerson": "李四",
  "dutyPhone": "13900000000",
  "dutyDate": "2024-07-16",
  "createdAt": "2024-07-16T10:00:00",
  "updatedAt": "2024-07-16T10:00:00"
}
```

**接口示例**:
- `GET /api/stat/duty` - 获取所有值班安排
- `GET /api/stat/duty/1` - 获取ID为1的值班安排
- `POST /api/stat/duty` - 创建新的值班安排
- `PUT /api/stat/duty/1` - 更新ID为1的值班安排
- `DELETE /api/stat/duty/1` - 删除ID为1的值班安排
- `DELETE /api/stat/duty` - 批量删除值班安排

---

## 请求示例

### 创建新记录
```bash
POST /api/stat/alarm
Content-Type: application/json

{
  "statDate": "2024-07-16",
  "successCount": 120,
  "suspiciousCount": 35,
  "attemptCount": 256
}
```

### 更新记录
```bash
PUT /api/stat/alarm/1
Content-Type: application/json

{
  "successCount": 150,
  "suspiciousCount": 40
}
```

### 批量删除
```bash
DELETE /api/stat/alarm
Content-Type: application/json

[1, 2, 3, 4]
```

---

## 说明

- 所有接口均支持完整的CRUD操作
- GET 接口返回全量数据列表或单个记录
- POST 接口用于创建新的统计记录
- PUT 接口用于更新指定记录
- DELETE 接口用于删除指定记录或批量删除
- 时间字段均为 ISO8601 格式
- `createdAt` 和 `updatedAt` 字段由系统自动维护，POST/PUT 时无需提供
- 所有数值型字段默认值为 0
- `isDomestic` 字段表示是否为国内IP，true 表示国内，false 表示国外
- 批量删除时，请求体为JSON数组格式，包含要删除的记录ID
- 所有接口都支持标准的HTTP状态码响应 